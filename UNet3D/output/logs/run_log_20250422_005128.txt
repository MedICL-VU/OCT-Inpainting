Starting Inpainting Pipeline
Device: cuda
Epochs: 50 | Batch size: 4 | Stack size: 16
Loading datasets...
Training volumes:
 - 1.1_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
 - 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_corrupted.tif
 - 1.4_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
Validation volume:
 - 3.4_OCT_uint16_Cropped_Reflected_VolumeSplit_2_RegSeq_seqSVD_corrupted.tif
Test volume:
 - 5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_corrupted.tif
Using 3 volumes for training, 1 for testing
Initializing model...
Starting training...
Train SSIM-L1 Breakdown | Avg Loss: 0.3111 | L1: 0.1261 | SSIM: 0.7422
[Epoch 1] Train Loss: 0.3111 | Val Loss: 0.2566
Validation loss improved to 0.256572
Train SSIM-L1 Breakdown | Avg Loss: 0.1584 | L1: 0.0628 | SSIM: 0.3816
[Epoch 2] Train Loss: 0.1584 | Val Loss: 0.1621
Validation loss improved to 0.162089
Train SSIM-L1 Breakdown | Avg Loss: 0.1195 | L1: 0.0402 | SSIM: 0.3043
[Epoch 3] Train Loss: 0.1195 | Val Loss: 0.1146
Validation loss improved to 0.114626
Train SSIM-L1 Breakdown | Avg Loss: 0.1028 | L1: 0.0287 | SSIM: 0.2758
[Epoch 4] Train Loss: 0.1028 | Val Loss: 0.1115
Validation loss improved to 0.111529
Train SSIM-L1 Breakdown | Avg Loss: 0.0939 | L1: 0.0237 | SSIM: 0.2576
[Epoch 5] Train Loss: 0.0939 | Val Loss: 0.1000
Validation loss improved to 0.100029
Train SSIM-L1 Breakdown | Avg Loss: 0.0846 | L1: 0.0199 | SSIM: 0.2354
[Epoch 6] Train Loss: 0.0846 | Val Loss: 0.0865
Validation loss improved to 0.086472
Train SSIM-L1 Breakdown | Avg Loss: 0.0815 | L1: 0.0184 | SSIM: 0.2287
[Epoch 7] Train Loss: 0.0815 | Val Loss: 0.0875
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0788 | L1: 0.0174 | SSIM: 0.2221
[Epoch 8] Train Loss: 0.0788 | Val Loss: 0.0818
Validation loss improved to 0.081791
Train SSIM-L1 Breakdown | Avg Loss: 0.0747 | L1: 0.0162 | SSIM: 0.2114
[Epoch 9] Train Loss: 0.0747 | Val Loss: 0.0859
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0717 | L1: 0.0155 | SSIM: 0.2028
[Epoch 10] Train Loss: 0.0717 | Val Loss: 0.0916
No improvement (2/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0706 | L1: 0.0152 | SSIM: 0.1998
[Epoch 11] Train Loss: 0.0706 | Val Loss: 0.1255
No improvement (3/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0699 | L1: 0.0150 | SSIM: 0.1978
[Epoch 12] Train Loss: 0.0699 | Val Loss: 0.0896
No improvement (4/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0702 | L1: 0.0150 | SSIM: 0.1990
[Epoch 13] Train Loss: 0.0702 | Val Loss: 0.0841
No improvement (5/5)
Early stopping triggered at epoch 13
Training completed.
Evaluating on held-out test volume...
Final test loss: 0.0637
Inpainting held-out test volume...
Inpainted volume saved to: /media/admin/Expansion/Mosaic_Data_for_Ipeks_Group/OCT_Inpainting_Testing/5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_inpainted_3DUNet.tif
