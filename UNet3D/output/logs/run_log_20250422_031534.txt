Starting Inpainting Pipeline
Device: cuda
Epochs: 50 | Batch size: 4 | Stack size: 16
Loading datasets...
Training volumes:
 - 1.1_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
 - 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_corrupted.tif
 - 1.4_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
Validation volume:
 - 3.4_OCT_uint16_Cropped_Reflected_VolumeSplit_2_RegSeq_seqSVD_corrupted.tif
Test volume:
 - 5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_corrupted.tif
Using 3 volumes for training, 1 for testing
Initializing model...
Starting training...
Train SSIM-L1 Breakdown | Avg Loss: 0.1725 | L1: 0.0727 | SSIM: 0.6956
[Epoch 1] Train Loss: 0.1725 | Val Loss: 0.0643
Validation loss improved to 0.064303
Train SSIM-L1 Breakdown | Avg Loss: 0.0467 | L1: 0.0161 | SSIM: 0.2071
[Epoch 2] Train Loss: 0.0467 | Val Loss: 0.0469
Validation loss improved to 0.046928
Train SSIM-L1 Breakdown | Avg Loss: 0.0408 | L1: 0.0132 | SSIM: 0.1857
[Epoch 3] Train Loss: 0.0408 | Val Loss: 0.0456
Validation loss improved to 0.045563
Train SSIM-L1 Breakdown | Avg Loss: 0.0392 | L1: 0.0124 | SSIM: 0.1798
[Epoch 4] Train Loss: 0.0392 | Val Loss: 0.0438
Validation loss improved to 0.043816
Train SSIM-L1 Breakdown | Avg Loss: 0.0382 | L1: 0.0120 | SSIM: 0.1758
[Epoch 5] Train Loss: 0.0382 | Val Loss: 0.0428
Validation loss improved to 0.042776
Train SSIM-L1 Breakdown | Avg Loss: 0.0375 | L1: 0.0118 | SSIM: 0.1727
[Epoch 6] Train Loss: 0.0375 | Val Loss: 0.0423
Validation loss improved to 0.042270
Train SSIM-L1 Breakdown | Avg Loss: 0.0369 | L1: 0.0116 | SSIM: 0.1698
[Epoch 7] Train Loss: 0.0369 | Val Loss: 0.0414
Validation loss improved to 0.041415
Train SSIM-L1 Breakdown | Avg Loss: 0.0364 | L1: 0.0115 | SSIM: 0.1672
[Epoch 8] Train Loss: 0.0364 | Val Loss: 0.0409
Validation loss improved to 0.040887
Train SSIM-L1 Breakdown | Avg Loss: 0.0359 | L1: 0.0113 | SSIM: 0.1650
[Epoch 9] Train Loss: 0.0359 | Val Loss: 0.0407
Validation loss improved to 0.040650
Train SSIM-L1 Breakdown | Avg Loss: 0.0356 | L1: 0.0112 | SSIM: 0.1632
[Epoch 10] Train Loss: 0.0356 | Val Loss: 0.0401
Validation loss improved to 0.040108
Train SSIM-L1 Breakdown | Avg Loss: 0.0352 | L1: 0.0112 | SSIM: 0.1616
[Epoch 11] Train Loss: 0.0352 | Val Loss: 0.0399
Validation loss improved to 0.039944
Train SSIM-L1 Breakdown | Avg Loss: 0.0349 | L1: 0.0111 | SSIM: 0.1599
[Epoch 12] Train Loss: 0.0349 | Val Loss: 0.0395
Validation loss improved to 0.039500
Train SSIM-L1 Breakdown | Avg Loss: 0.0345 | L1: 0.0110 | SSIM: 0.1579
[Epoch 13] Train Loss: 0.0345 | Val Loss: 0.0390
Validation loss improved to 0.039044
Train SSIM-L1 Breakdown | Avg Loss: 0.0342 | L1: 0.0110 | SSIM: 0.1562
[Epoch 14] Train Loss: 0.0342 | Val Loss: 0.0389
Validation loss improved to 0.038929
Train SSIM-L1 Breakdown | Avg Loss: 0.0338 | L1: 0.0109 | SSIM: 0.1543
[Epoch 15] Train Loss: 0.0338 | Val Loss: 0.0387
Validation loss improved to 0.038730
Train SSIM-L1 Breakdown | Avg Loss: 0.0335 | L1: 0.0108 | SSIM: 0.1526
[Epoch 16] Train Loss: 0.0335 | Val Loss: 0.0383
Validation loss improved to 0.038318
Train SSIM-L1 Breakdown | Avg Loss: 0.0334 | L1: 0.0108 | SSIM: 0.1517
[Epoch 17] Train Loss: 0.0334 | Val Loss: 0.0387
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0331 | L1: 0.0108 | SSIM: 0.1502
[Epoch 18] Train Loss: 0.0331 | Val Loss: 0.0378
Validation loss improved to 0.037780
Train SSIM-L1 Breakdown | Avg Loss: 0.0328 | L1: 0.0107 | SSIM: 0.1487
[Epoch 19] Train Loss: 0.0328 | Val Loss: 0.0375
Validation loss improved to 0.037546
Train SSIM-L1 Breakdown | Avg Loss: 0.0326 | L1: 0.0107 | SSIM: 0.1475
[Epoch 20] Train Loss: 0.0326 | Val Loss: 0.0374
Validation loss improved to 0.037411
Train SSIM-L1 Breakdown | Avg Loss: 0.0324 | L1: 0.0107 | SSIM: 0.1464
[Epoch 21] Train Loss: 0.0324 | Val Loss: 0.0372
Validation loss improved to 0.037236
Train SSIM-L1 Breakdown | Avg Loss: 0.0321 | L1: 0.0106 | SSIM: 0.1451
[Epoch 22] Train Loss: 0.0321 | Val Loss: 0.0380
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0320 | L1: 0.0106 | SSIM: 0.1445
[Epoch 23] Train Loss: 0.0320 | Val Loss: 0.0371
Validation loss improved to 0.037058
Train SSIM-L1 Breakdown | Avg Loss: 0.0318 | L1: 0.0106 | SSIM: 0.1435
[Epoch 24] Train Loss: 0.0318 | Val Loss: 0.0371
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0316 | L1: 0.0105 | SSIM: 0.1423
[Epoch 25] Train Loss: 0.0316 | Val Loss: 0.0367
Validation loss improved to 0.036713
Train SSIM-L1 Breakdown | Avg Loss: 0.0314 | L1: 0.0105 | SSIM: 0.1412
[Epoch 26] Train Loss: 0.0314 | Val Loss: 0.0366
Validation loss improved to 0.036561
Train SSIM-L1 Breakdown | Avg Loss: 0.0312 | L1: 0.0105 | SSIM: 0.1403
[Epoch 27] Train Loss: 0.0312 | Val Loss: 0.0370
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0310 | L1: 0.0104 | SSIM: 0.1392
[Epoch 28] Train Loss: 0.0310 | Val Loss: 0.0362
Validation loss improved to 0.036188
Train SSIM-L1 Breakdown | Avg Loss: 0.0309 | L1: 0.0104 | SSIM: 0.1385
[Epoch 29] Train Loss: 0.0309 | Val Loss: 0.0360
Validation loss improved to 0.036014
Train SSIM-L1 Breakdown | Avg Loss: 0.0307 | L1: 0.0104 | SSIM: 0.1377
[Epoch 30] Train Loss: 0.0307 | Val Loss: 0.0361
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0306 | L1: 0.0104 | SSIM: 0.1369
[Epoch 31] Train Loss: 0.0306 | Val Loss: 0.0365
No improvement (2/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0304 | L1: 0.0103 | SSIM: 0.1358
[Epoch 32] Train Loss: 0.0304 | Val Loss: 0.0355
Validation loss improved to 0.035547
Train SSIM-L1 Breakdown | Avg Loss: 0.0302 | L1: 0.0103 | SSIM: 0.1350
[Epoch 33] Train Loss: 0.0302 | Val Loss: 0.0354
Validation loss improved to 0.035413
Train SSIM-L1 Breakdown | Avg Loss: 0.0302 | L1: 0.0103 | SSIM: 0.1347
[Epoch 34] Train Loss: 0.0302 | Val Loss: 0.0355
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0300 | L1: 0.0102 | SSIM: 0.1337
[Epoch 35] Train Loss: 0.0300 | Val Loss: 0.0353
No improvement (2/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0299 | L1: 0.0102 | SSIM: 0.1330
[Epoch 36] Train Loss: 0.0299 | Val Loss: 0.0353
Validation loss improved to 0.035294
Train SSIM-L1 Breakdown | Avg Loss: 0.0298 | L1: 0.0102 | SSIM: 0.1326
[Epoch 37] Train Loss: 0.0298 | Val Loss: 0.0349
Validation loss improved to 0.034924
Train SSIM-L1 Breakdown | Avg Loss: 0.0296 | L1: 0.0102 | SSIM: 0.1317
[Epoch 38] Train Loss: 0.0296 | Val Loss: 0.0351
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0295 | L1: 0.0101 | SSIM: 0.1310
[Epoch 39] Train Loss: 0.0295 | Val Loss: 0.0349
No improvement (2/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0294 | L1: 0.0101 | SSIM: 0.1304
[Epoch 40] Train Loss: 0.0294 | Val Loss: 0.0347
Validation loss improved to 0.034677
Train SSIM-L1 Breakdown | Avg Loss: 0.0295 | L1: 0.0102 | SSIM: 0.1312
[Epoch 41] Train Loss: 0.0295 | Val Loss: 0.0351
No improvement (1/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0293 | L1: 0.0101 | SSIM: 0.1301
[Epoch 42] Train Loss: 0.0293 | Val Loss: 0.0348
No improvement (2/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0291 | L1: 0.0101 | SSIM: 0.1292
[Epoch 43] Train Loss: 0.0291 | Val Loss: 0.0347
No improvement (3/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0290 | L1: 0.0101 | SSIM: 0.1287
[Epoch 44] Train Loss: 0.0290 | Val Loss: 0.0346
No improvement (4/5)
Train SSIM-L1 Breakdown | Avg Loss: 0.0291 | L1: 0.0101 | SSIM: 0.1289
[Epoch 45] Train Loss: 0.0291 | Val Loss: 0.0348
No improvement (5/5)
Early stopping triggered at epoch 45
Training completed.
Evaluating on held-out test volume...
Final test loss: 0.0270
Inpainting held-out test volume...
Inpainted volume saved to: /media/admin/Expansion/Mosaic_Data_for_Ipeks_Group/OCT_Inpainting_Testing/5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_inpainted_3DUNet.tif
