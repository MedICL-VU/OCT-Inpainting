Starting Inpainting Pipeline
Device: cuda
Epochs: 50 | Batch size: 8 | Stack size: 9
Loading datasets...

========== Fold 1 ==========
Training volumes:
 - 1.4_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_Cropped_corrupted.tif
 - 3.4_OCT_uint16_Cropped_Reflected_VolumeSplit_2_RegSeq_seqSVD_Cropped_corrupted.tif
 - 5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_Cropped_corrupted.tif
Validation volume:
 - 1.1_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_Cropped_corrupted.tif
Test volume:
 - 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_Cropped_corrupted.tif
Using 3 volumes for training, 1 for validation, 1 for testing
Initializing model...
Starting training...
[Epoch 1] Train Loss: 0.3557 | Val Loss: 0.2371
Validation loss improved to 0.237061
[Epoch 2] Train Loss: 0.1804 | Val Loss: 0.1478
Validation loss improved to 0.147822
[Epoch 3] Train Loss: 0.1072 | Val Loss: 0.1033
Validation loss improved to 0.103312
[Epoch 4] Train Loss: 0.0816 | Val Loss: 0.0857
Validation loss improved to 0.085662
[Epoch 5] Train Loss: 0.0738 | Val Loss: 0.0739
Validation loss improved to 0.073890
[Epoch 6] Train Loss: 0.0670 | Val Loss: 0.0697
Validation loss improved to 0.069664
[Epoch 7] Train Loss: 0.0641 | Val Loss: 0.0681
Validation loss improved to 0.068088
[Epoch 8] Train Loss: 0.0617 | Val Loss: 0.0656
Validation loss improved to 0.065581
[Epoch 9] Train Loss: 0.0610 | Val Loss: 0.0676
No improvement (1/5)
[Epoch 10] Train Loss: 0.0605 | Val Loss: 0.0635
Validation loss improved to 0.063452
[Epoch 11] Train Loss: 0.0586 | Val Loss: 0.0632
Validation loss improved to 0.063188
[Epoch 12] Train Loss: 0.0576 | Val Loss: 0.0672
No improvement (1/5)
[Epoch 13] Train Loss: 0.0578 | Val Loss: 0.0620
Validation loss improved to 0.061964
[Epoch 14] Train Loss: 0.0577 | Val Loss: 0.0617
Validation loss improved to 0.061677
[Epoch 15] Train Loss: 0.0563 | Val Loss: 0.0612
Validation loss improved to 0.061152
[Epoch 16] Train Loss: 0.0562 | Val Loss: 0.0615
No improvement (1/5)
[Epoch 17] Train Loss: 0.0558 | Val Loss: 0.0611
No improvement (2/5)
[Epoch 18] Train Loss: 0.0557 | Val Loss: 0.0625
No improvement (3/5)
[Epoch 19] Train Loss: 0.0560 | Val Loss: 0.0606
Validation loss improved to 0.060585
[Epoch 20] Train Loss: 0.0552 | Val Loss: 0.0616
No improvement (1/5)
[Epoch 21] Train Loss: 0.0547 | Val Loss: 0.0602
Validation loss improved to 0.060165
[Epoch 22] Train Loss: 0.0546 | Val Loss: 0.0601
No improvement (1/5)
[Epoch 23] Train Loss: 0.0548 | Val Loss: 0.0655
No improvement (2/5)
[Epoch 24] Train Loss: 0.0553 | Val Loss: 0.0593
Validation loss improved to 0.059321
[Epoch 25] Train Loss: 0.0553 | Val Loss: 0.0619
No improvement (1/5)
[Epoch 26] Train Loss: 0.0544 | Val Loss: 0.0592
Validation loss improved to 0.059193
[Epoch 27] Train Loss: 0.0539 | Val Loss: 0.0596
No improvement (1/5)
[Epoch 28] Train Loss: 0.0539 | Val Loss: 0.0592
No improvement (2/5)
[Epoch 29] Train Loss: 0.0536 | Val Loss: 0.0601
No improvement (3/5)
[Epoch 30] Train Loss: 0.0535 | Val Loss: 0.0592
No improvement (4/5)
[Epoch 31] Train Loss: 0.0540 | Val Loss: 0.0592
No improvement (5/5)
Early stopping triggered at epoch 31
Training completed.
Evaluating on held-out test volume...
Final test loss: 0.0574
Inpainting volume...
Inpainted volume saved to: /media/admin/Expansion/Mosaic_Data_for_Ipeks_Group/OCT_Inpainting_Testing/1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_Cropped_inpainted_2p5DUNet_fold1_v2cropped.tif
Evaluating inpainted volume metrics...
Volume Metrics for 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_Cropped:
 - L1 Loss: 0.0023
 - SSIM: 0.9628
 - Mean Intensity Diff: 0.0002

===== K-FOLD AVERAGE TEST LOSS: 0.0574 =====
