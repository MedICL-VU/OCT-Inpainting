Starting Inpainting Pipeline
Device: cuda
Epochs: 50 | Batch size: 8 | Stack size: 9
Loading datasets...

========== Fold 2 ==========
Training volumes:
 - 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_corrupted.tif
 - 1.4_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
 - 3.4_OCT_uint16_Cropped_Reflected_VolumeSplit_2_RegSeq_seqSVD_corrupted.tif
Validation volume:
 - 1.1_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
Test volume:
 - 5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_corrupted.tif
Using 3 volumes for training, 1 for validation, 1 for testing
Initializing model...
Starting training...
[Epoch 1] Train Loss: 0.3563 | Val Loss: 0.2704
Validation loss improved to 0.270441
[Epoch 2] Train Loss: 0.2402 | Val Loss: 0.2119
Validation loss improved to 0.211918
[Epoch 3] Train Loss: 0.1729 | Val Loss: 0.1564
Validation loss improved to 0.156434
[Epoch 4] Train Loss: 0.1219 | Val Loss: 0.0968
Validation loss improved to 0.096755
[Epoch 5] Train Loss: 0.0962 | Val Loss: 0.0944
Validation loss improved to 0.094418
[Epoch 6] Train Loss: 0.0825 | Val Loss: 0.0747
Validation loss improved to 0.074670
[Epoch 7] Train Loss: 0.0746 | Val Loss: 0.0650
Validation loss improved to 0.064972
[Epoch 8] Train Loss: 0.0669 | Val Loss: 0.0591
Validation loss improved to 0.059123
[Epoch 9] Train Loss: 0.0611 | Val Loss: 0.0576
Validation loss improved to 0.057581
[Epoch 10] Train Loss: 0.0627 | Val Loss: 0.0545
Validation loss improved to 0.054537
[Epoch 11] Train Loss: 0.0579 | Val Loss: 0.0566
No improvement (1/5)
[Epoch 12] Train Loss: 0.0559 | Val Loss: 0.0533
Validation loss improved to 0.053307
[Epoch 13] Train Loss: 0.0533 | Val Loss: 0.0518
Validation loss improved to 0.051841
[Epoch 14] Train Loss: 0.0527 | Val Loss: 0.0499
Validation loss improved to 0.049891
[Epoch 15] Train Loss: 0.0517 | Val Loss: 0.0489
Validation loss improved to 0.048869
[Epoch 16] Train Loss: 0.0506 | Val Loss: 0.0494
No improvement (1/5)
[Epoch 17] Train Loss: 0.0503 | Val Loss: 0.0487
Validation loss improved to 0.048701
[Epoch 18] Train Loss: 0.0501 | Val Loss: 0.0492
No improvement (1/5)
[Epoch 19] Train Loss: 0.0489 | Val Loss: 0.0472
Validation loss improved to 0.047172
[Epoch 20] Train Loss: 0.0489 | Val Loss: 0.0472
No improvement (1/5)
[Epoch 21] Train Loss: 0.0485 | Val Loss: 0.0479
No improvement (2/5)
[Epoch 22] Train Loss: 0.0479 | Val Loss: 0.0470
Validation loss improved to 0.047015
[Epoch 23] Train Loss: 0.0480 | Val Loss: 0.0468
Validation loss improved to 0.046802
[Epoch 24] Train Loss: 0.0476 | Val Loss: 0.0468
No improvement (1/5)
[Epoch 25] Train Loss: 0.0471 | Val Loss: 0.0459
Validation loss improved to 0.045875
[Epoch 26] Train Loss: 0.0475 | Val Loss: 0.0466
No improvement (1/5)
[Epoch 27] Train Loss: 0.0463 | Val Loss: 0.0455
Validation loss improved to 0.045526
[Epoch 28] Train Loss: 0.0466 | Val Loss: 0.0463
No improvement (1/5)
[Epoch 29] Train Loss: 0.0464 | Val Loss: 0.0461
No improvement (2/5)
[Epoch 30] Train Loss: 0.0462 | Val Loss: 0.0457
No improvement (3/5)
[Epoch 31] Train Loss: 0.0463 | Val Loss: 0.0538
No improvement (4/5)
[Epoch 32] Train Loss: 0.0467 | Val Loss: 0.0457
No improvement (5/5)
Early stopping triggered at epoch 32
Training completed.
Evaluating on held-out test volume...
Final test loss: 0.0402
Inpainting volume...
Inpainted volume saved to: /media/admin/Expansion/Mosaic_Data_for_Ipeks_Group/OCT_Inpainting_Testing/5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_inpainted_2p5DUNet_fold2.tif

===== K-FOLD AVERAGE TEST LOSS: 0.0402 =====
