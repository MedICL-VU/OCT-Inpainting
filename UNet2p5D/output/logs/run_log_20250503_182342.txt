Starting Inpainting Pipeline
Device: cuda
Epochs: 50 | Batch size: 8 | Stack size: 9
Loading datasets...

========== Fold 1 ==========
Training volumes:
 - 1.4_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
 - 3.4_OCT_uint16_Cropped_Reflected_VolumeSplit_2_RegSeq_seqSVD_corrupted.tif
 - 5.3_OCT_uint16_Cropped_Reflected_VolumeSplit_1_RegSeq_seqSVD_corrupted.tif
Validation volume:
 - 1.1_OCT_uint16_Cropped_VolumeSplit_1_Reflected_RegSeq_seqSVD_corrupted.tif
Test volume:
 - 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_corrupted.tif
Using 3 volumes for training, 1 for validation, 1 for testing
Initializing model...
Starting training...
[Epoch 1] Train Loss: 0.4038 | Val Loss: 0.3208
Validation loss improved to 0.320814
[Epoch 2] Train Loss: 0.3256 | Val Loss: 0.3029
Validation loss improved to 0.302855
[Epoch 3] Train Loss: 0.2595 | Val Loss: 0.2501
Validation loss improved to 0.250084
[Epoch 4] Train Loss: 0.1767 | Val Loss: 0.2071
Validation loss improved to 0.207114
[Epoch 5] Train Loss: 0.1387 | Val Loss: 0.1504
Validation loss improved to 0.150422
[Epoch 6] Train Loss: 0.1182 | Val Loss: 0.1506
No improvement (1/5)
[Epoch 7] Train Loss: 0.1008 | Val Loss: 0.1155
Validation loss improved to 0.115518
[Epoch 8] Train Loss: 0.0865 | Val Loss: 0.0840
Validation loss improved to 0.084006
[Epoch 9] Train Loss: 0.0726 | Val Loss: 0.0733
Validation loss improved to 0.073293
[Epoch 10] Train Loss: 0.0606 | Val Loss: 0.0581
Validation loss improved to 0.058105
[Epoch 11] Train Loss: 0.0522 | Val Loss: 0.0550
Validation loss improved to 0.055027
[Epoch 12] Train Loss: 0.0485 | Val Loss: 0.0523
Validation loss improved to 0.052271
[Epoch 13] Train Loss: 0.0469 | Val Loss: 0.0510
Validation loss improved to 0.051015
[Epoch 14] Train Loss: 0.0458 | Val Loss: 0.0490
Validation loss improved to 0.048952
[Epoch 15] Train Loss: 0.0448 | Val Loss: 0.0487
Validation loss improved to 0.048663
[Epoch 16] Train Loss: 0.0440 | Val Loss: 0.0470
Validation loss improved to 0.046983
[Epoch 17] Train Loss: 0.0434 | Val Loss: 0.0484
No improvement (1/5)
[Epoch 18] Train Loss: 0.0431 | Val Loss: 0.0469
Validation loss improved to 0.046866
[Epoch 19] Train Loss: 0.0427 | Val Loss: 0.0462
Validation loss improved to 0.046249
[Epoch 20] Train Loss: 0.0425 | Val Loss: 0.0462
No improvement (1/5)
[Epoch 21] Train Loss: 0.0422 | Val Loss: 0.0456
Validation loss improved to 0.045637
[Epoch 22] Train Loss: 0.0421 | Val Loss: 0.0453
Validation loss improved to 0.045336
[Epoch 23] Train Loss: 0.0420 | Val Loss: 0.0457
No improvement (1/5)
[Epoch 24] Train Loss: 0.0419 | Val Loss: 0.0472
No improvement (2/5)
[Epoch 25] Train Loss: 0.0430 | Val Loss: 0.0452
Validation loss improved to 0.045175
[Epoch 26] Train Loss: 0.0419 | Val Loss: 0.0461
No improvement (1/5)
[Epoch 27] Train Loss: 0.0417 | Val Loss: 0.0445
Validation loss improved to 0.044505
[Epoch 28] Train Loss: 0.0417 | Val Loss: 0.0485
No improvement (1/5)
[Epoch 29] Train Loss: 0.0418 | Val Loss: 0.0449
No improvement (2/5)
[Epoch 30] Train Loss: 0.0416 | Val Loss: 0.0455
No improvement (3/5)
[Epoch 31] Train Loss: 0.0414 | Val Loss: 0.0452
No improvement (4/5)
[Epoch 32] Train Loss: 0.0414 | Val Loss: 0.0442
Validation loss improved to 0.044207
[Epoch 33] Train Loss: 0.0413 | Val Loss: 0.0448
No improvement (1/5)
[Epoch 34] Train Loss: 0.0413 | Val Loss: 0.0442
No improvement (2/5)
[Epoch 35] Train Loss: 0.0412 | Val Loss: 0.0447
No improvement (3/5)
[Epoch 36] Train Loss: 0.0411 | Val Loss: 0.0444
No improvement (4/5)
[Epoch 37] Train Loss: 0.0410 | Val Loss: 0.0436
Validation loss improved to 0.043647
[Epoch 38] Train Loss: 0.0410 | Val Loss: 0.0445
No improvement (1/5)
[Epoch 39] Train Loss: 0.0409 | Val Loss: 0.0446
No improvement (2/5)
[Epoch 40] Train Loss: 0.0412 | Val Loss: 0.0442
No improvement (3/5)
[Epoch 41] Train Loss: 0.0410 | Val Loss: 0.0442
No improvement (4/5)
[Epoch 42] Train Loss: 0.0409 | Val Loss: 0.0457
No improvement (5/5)
Early stopping triggered at epoch 42
Training completed.
Evaluating on held-out test volume...
Final test loss: 0.0428
Inpainting volume...
Inpainted volume saved to: /media/admin/Expansion/Mosaic_Data_for_Ipeks_Group/OCT_Inpainting_Testing/1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD_inpainted_2p5DUNet_fold1_v2.tif
Evaluating inpainted volume metrics...
Volume Metrics for 1.2_OCT_uint16_Cropped_VolumeSplit_2_Reflected_RegSeq_seqSVD:
 - L1 Loss: 0.0019
 - SSIM: 0.9726
 - Mean Intensity Diff: 0.0

===== K-FOLD AVERAGE TEST LOSS: 0.0428 =====
